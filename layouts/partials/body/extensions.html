{{ if .Store.Get "hasMermaid" }}
  {{ with resources.GetRemote "https://cdn.jsdelivr.net/npm/mermaid@11/dist/mermaid.min.js" }}
    <script src="{{ .RelPermalink }}" integrity="{{ (. | fingerprint).Data.Integrity }}" crossorigin="anonymous"></script>
  {{ end }}
  <script>
    const isDarkMode = document.documentElement.style.colorScheme == 'dark';
    mermaid.initialize({ startOnLoad: true, theme: isDarkMode ? 'dark' : 'default' });
  </script>
{{ end }}

{{ if not hugo.IsServer }}
  <script data-goatcounter="https://jojonas.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
{{ end }}